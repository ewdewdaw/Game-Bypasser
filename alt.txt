-- Roblox script for Delta executor
-- This script checks a Firebase DB every 5 seconds for scripts to execute

local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")

-- Function to make screen black
local function makeScreenBlack()
    if game:GetService("CoreGui") then
        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "BlackScreenGui"
        screenGui.IgnoreGuiInset = true
        screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(1, 0, 1, 0)
        frame.BackgroundColor3 = Color3.new(0, 0, 0)
        frame.BorderSizePixel = 0
        frame.Parent = screenGui
        
        screenGui.Parent = game:GetService("CoreGui")
    end
end

-- Function to check and execute scripts from Firebase
local function checkAndExecuteScript()
    local url = "https://omebgle-default-rtdb.firebaseio.com/script.json"
    
    local success, response = pcall(function()
        return HttpService:GetAsync(url, true)
    end)
    
    if success then
        local data = HttpService:JSONDecode(response)
        if data and data.code then
            -- Execute the script
            local executeSuccess, errorMsg = pcall(function()
                loadstring(data.code)()
            end)
            
            if not executeSuccess then
                warn("Script execution error: " .. errorMsg)
            else
                -- Clear the script from DB after successful execution
                pcall(function()
                    HttpService:RequestAsync({
                        Url = url,
                        Method = "PUT",
                        Headers = {
                            ["Content-Type"] = "application/json"
                        },
                        Body = HttpService:JSONEncode({code = ""})
                    })
                end)
            end
        end
    else
        warn("Failed to fetch from database: " .. response)
    end
end

-- Initial setup
makeScreenBlack()

-- Set up periodic checking
local checkInterval = 5
local lastCheck = os.time()

RunService.Heartbeat:Connect(function()
    if os.time() - lastCheck >= checkInterval then
        lastCheck = os.time()
        checkAndExecuteScript()
    end
end)
